session_name: launch_tare

environment:
  ROBOT1_ID: "0" 
  ROBOT1_CONTAINER_NAME: robot1 
  ROBOT2_ID: "1"
  ROBOT2_CONTAINER_NAME: robot2 
  ROBOT3_ID: "2" 
  ROBOT3_CONTAINER_NAME: robot3 
  SCENARIO: tunnel 
  TOTAL_ROBOT_NUM: "3" 
  TEST_ID: "000330"
  ROOT_FOLDER: /home/docker-user/mtare

suppress_history: true

before_script: docker compose -f ./docker-compose-launch-robots.yml up -d

windows:
  - window_name: ROS_CORE
    focus: false
    layout: tiled
    panes:
      - shell_command:
        - docker exec -it ${ROBOT1_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && roscore"
      - shell_command:
        - docker exec -it ${ROBOT2_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && roscore"
      - shell_command:
        - docker exec -it ${ROBOT3_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && roscore"
  - window_name: ROS_BRIDGE
    focus: false
    layout: tiled
    panes:
      - shell_command:
        - docker exec -it ${ROBOT1_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && roslaunch --wait tare_planner param.launch && source /opt/ros/galactic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && source $ROOT_FOLDER/colcon_ws/install/local_setup.bash && source $ROOT_FOLDER/ros1_bridge/install/local_setup.bash && ros2 run ros1_bridge parameter_bridge"
      - shell_command:
        - docker exec -it ${ROBOT2_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && roslaunch --wait tare_planner param.launch && source /opt/ros/galactic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && source $ROOT_FOLDER/colcon_ws/install/local_setup.bash && source $ROOT_FOLDER/ros1_bridge/install/local_setup.bash && ros2 run ros1_bridge parameter_bridge"
      - shell_command:
        - docker exec -it ${ROBOT3_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && roslaunch --wait tare_planner param.launch && source /opt/ros/galactic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && source $ROOT_FOLDER/colcon_ws/install/local_setup.bash && source $ROOT_FOLDER/ros1_bridge/install/local_setup.bash && ros2 run ros1_bridge parameter_bridge"
  - window_name: DEV_ENV
    focus: false
    layout: tiled
    panes:
      - shell_command:
        - docker exec -it ${ROBOT1_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/autonomous_exploration_development_environment/devel/setup.bash && roslaunch --wait vehicle_simulator system_${SCENARIO}.launch robot_id:=${ROBOT1_ID}"
      - shell_command:
        - docker exec -it ${ROBOT2_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/autonomous_exploration_development_environment/devel/setup.bash && roslaunch --wait vehicle_simulator system_${SCENARIO}.launch robot_id:=${ROBOT2_ID}"
      - shell_command:
        - docker exec -it ${ROBOT3_CONTAINER_NAME} bash -c "source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/autonomous_exploration_development_environment/devel/setup.bash && roslaunch --wait vehicle_simulator system_${SCENARIO}.launch robot_id:=${ROBOT3_ID}"
  - window_name: TARE
    focus: true
    layout: tiled
    panes:
      - shell_command:
        - docker exec -it ${ROBOT1_CONTAINER_NAME} bash -c "export DISPLAY=:1 && source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && roslaunch --wait tare_planner explore_${SCENARIO}.launch robot_id:=${ROBOT1_ID} robot_num:=${TOTAL_ROBOT_NUM} test_id:=${TEST_ID} rviz:=true"
      - shell_command:
        - docker exec -it ${ROBOT2_CONTAINER_NAME} bash -c "export DISPLAY=:1 && source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && roslaunch --wait tare_planner explore_${SCENARIO}.launch robot_id:=${ROBOT2_ID} robot_num:=${TOTAL_ROBOT_NUM} test_id:=${TEST_ID} rviz:=true"
      - shell_command:
        - docker exec -it ${ROBOT3_CONTAINER_NAME} bash -c "export DISPLAY=:1 && source /opt/ros/noetic/setup.bash && source $ROOT_FOLDER/tare_system/devel/setup.bash && roslaunch --wait tare_planner explore_${SCENARIO}.launch robot_id:=${ROBOT3_ID} robot_num:=${TOTAL_ROBOT_NUM} test_id:=${TEST_ID} rviz:=true"